# Copyright 2023 Akretion - Raphaël Valyi <raphael.valyi@akretion.com>
# License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl-3.0.en.html).
# Generated by https://github.com/akretion/xsdata-odoo
#
import textwrap
from odoo import fields, models
from .tipos import (
    TIdeEmpregador,
    TIdeEventoTrabJud,
    TIdeVinculoBaixa,
)

__NAMESPACE__ = "http://www.esocial.gov.br/schema/evt/evtBaixa/v_S_01_01_00"


class ESocial(models.AbstractModel):
    "S-8299 - Baixa Judicial do Vínculo"
    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.esocial"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial"

    eso11_evtBaixa = fields.Many2one(
        comodel_name="eso.11.evtbaixa",
        string="Evento Baixa Judicial do Vínculo",
        xsd_required=True,
        help=(
            "Evento Baixa Judicial do Vínculo.\nCHAVE_GRUPO: {Id}\nREGRA:REGRA"
            "_BAIXA_JUDICIAL\nREGRA:REGRA_BAIXA_TRABALHADOR_AFASTADO\nREGRA:RE"
            "GRA_DESLIG_EXCLUI_DESLIGAMENTO_REINTEG\nREGRA:REGRA_DESLIG_EXCLUS"
            "AO_EVENTO\nREGRA:REGRA_DESLIG_EXISTE_EVENTO_POSTERIOR\nREGRA:REGR"
            "A_ENVIO_PROC_FECHAMENTO\nREGRA:REGRA_EVENTOS_EXTEMP\nREGRA:REGRA_"
            "EXISTE_INFO_EMPREGADOR\nREGRA:REGRA_RETIFICA_MESMO_VINCULO\nREGRA"
            ":REGRA_VINCULO_ATIVO_NA_DTEVENTO"
        ),
    )


class EvtBaixa(models.AbstractModel):
    """Evento Baixa Judicial do Vínculo.
    CHAVE_GRUPO: {Id}
    REGRA:REGRA_BAIXA_JUDICIAL
    REGRA:REGRA_BAIXA_TRABALHADOR_AFASTADO
    REGRA:REGRA_DESLIG_EXCLUI_DESLIGAMENTO_REINTEG
    REGRA:REGRA_DESLIG_EXCLUSAO_EVENTO
    REGRA:REGRA_DESLIG_EXISTE_EVENTO_POSTERIOR
    REGRA:REGRA_ENVIO_PROC_FECHAMENTO
    REGRA:REGRA_EVENTOS_EXTEMP
    REGRA:REGRA_EXISTE_INFO_EMPREGADOR
    REGRA:REGRA_RETIFICA_MESMO_VINCULO
    REGRA:REGRA_VINCULO_ATIVO_NA_DTEVENTO"""

    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.evtbaixa"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial.EvtBaixa"

    eso11_ideEvento = fields.Many2one(
        comodel_name="eso.11.tideeventotrabjud",
        string="ideEvento",
        xsd_required=True,
        xsd_type="T_ideEvento_trab_jud",
    )

    eso11_ideEmpregador = fields.Many2one(
        comodel_name="eso.11.tideempregador",
        string="ideEmpregador",
        xsd_required=True,
        xsd_type="T_ideEmpregador",
    )

    eso11_ideVinculo = fields.Many2one(
        comodel_name="eso.11.tidevinculobaixa",
        string="ideVinculo",
        xsd_required=True,
        xsd_type="T_ideVinculo_baixa",
    )

    eso11_infoBaixa = fields.Many2one(
        comodel_name="eso.11.infobaixa",
        string="Informações relativas à baixa judicial",
        xsd_required=True,
        help=(
            "Informações relativas à baixa judicial do vínculo.\nCHAVE_GRUPO: "
            "{dtDeslig*}"
        ),
    )

    eso11_Id = fields.Char(string="Id", xsd_required=True, xsd_type="TS_Id")


class InfoBaixa(models.AbstractModel):
    """Informações relativas à baixa judicial do vínculo.
    CHAVE_GRUPO: {dtDeslig*}"""

    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.infobaixa"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial.EvtBaixa.InfoBaixa"

    eso11_mtvDeslig = fields.Char(string="mtvDeslig", xsd_required=True)

    eso11_dtDeslig = fields.Date(
        string="a data de desligamento do vínculo",
        xsd_required=True,
        xsd_type="xs:date",
        help=(
            "a data de desligamento do vínculo (último dia "
            "trabalhado).\nValidação: Deve ser uma data igual ou posterior a "
            "24/09/2019 e igual ou anterior à data atual. No caso de empregado"
            " reintegrado e quando não se tratar de retificação do "
            "desligamento anterior à reintegração, também deve ser uma data "
            "igual ou posterior a "
            "{dtEfetRetorno}(2298_infoReintegr_dtEfetRetorno) do evento "
            "S-2298."
        ),
    )

    eso11_dtProjFimAPI = fields.Date(
        string="Data projetada para o término",
        xsd_type="xs:date",
        help=(
            "Data projetada para o término do aviso prévio "
            "indenizado.\nValidação: Se preenchida, deve ser uma data "
            "posterior a {dtDeslig}(./dtDeslig)."
        ),
    )

    eso11_nrProcTrab = fields.Char(
        string="Número que identifica",
        xsd_required=True,
        xsd_type="TS_nrProcJud",
        help=(
            "Número que identifica o processo judicial onde a baixa do vínculo"
            " foi determinada.\nValidação: Deve ser um processo judicial "
            "válido, com 20 (vinte) algarismos."
        ),
    )

    eso11_observacao = fields.Char(
        string="Observação relevante sobre",
        xsd_type="TS_observacao",
        help=(
            "Observação relevante sobre o desligamento do trabalhador, que não"
            " esteja consignada em outros campos."
        ),
    )
