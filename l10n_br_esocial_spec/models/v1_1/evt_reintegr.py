# Copyright 2023 Akretion - Raphaël Valyi <raphael.valyi@akretion.com>
# License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl-3.0.en.html).
# Generated by https://github.com/akretion/xsdata-odoo
#
import textwrap
from odoo import fields, models
from .tipos import (
    TIdeEmpregador,
    TIdeEventoTrab,
    TIdeVinculo,
)

__NAMESPACE__ = "http://www.esocial.gov.br/schema/evt/evtReintegr/v_S_01_01_00"

"""Tipo de reintegração/outro provimento.
    Validação: Os tipos [3, 4, 5] só podem ser informados se a natureza jurídica do
    declarante for Administração Pública (grupo [1])."""
INFOREINTEGR_TPREINT = [
  ("1", "Reintegração por decisão judicial"),
  ("2", "Reintegração por anistia legal"),
  ("3", "Reversão de servidor público"),
  ("4", "Recondução de servidor público"),
  ("5", "Reinclusão de militar"),
  ("9", "Outros"),
]


class ESocial(models.AbstractModel):
    "S-2298 - Reintegração/Outros Provimentos"
    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.esocial"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial"


    
    eso11_evtReintegr = fields.Many2one(
        comodel_name="eso.11.evtreintegr",
        string="Evento Reintegração/Outros Provimentos",
        xsd_required=True,
        help=(
            "Evento Reintegração/Outros Provimentos.\nCHAVE_GRUPO: {Id}\nREGRA"
            ":REGRA_EMPREGADO_DOMESTICO\nREGRA:REGRA_ENVIO_PROC_FECHAMENTO\nRE"
            "GRA:REGRA_EVENTOS_EXTEMP\nREGRA:REGRA_EVENTO_POSTERIOR_CAT_OBITO\"
            "nREGRA:REGRA_EXISTE_EVENTO_DESLIGAMENTO\nREGRA:REGRA_EXISTE_INFO_"
            "EMPREGADOR\nREGRA:REGRA_EXTEMP_REINTEGRACAO\nREGRA:REGRA_MESMO_PR"
            "OCEMI\nREGRA:REGRA_REINTEG_EXCLUSAO_EVENTO\nREGRA:REGRA_RETIFICA_"
            "MESMO_VINCULO\nREGRA:REGRA_VALIDA_EMPREGADOR"
        )
    )
    

class EvtReintegr(models.AbstractModel):
    """Evento Reintegração/Outros Provimentos.
    CHAVE_GRUPO: {Id}
    REGRA:REGRA_EMPREGADO_DOMESTICO
    REGRA:REGRA_ENVIO_PROC_FECHAMENTO
    REGRA:REGRA_EVENTOS_EXTEMP
    REGRA:REGRA_EVENTO_POSTERIOR_CAT_OBITO
    REGRA:REGRA_EXISTE_EVENTO_DESLIGAMENTO
    REGRA:REGRA_EXISTE_INFO_EMPREGADOR
    REGRA:REGRA_EXTEMP_REINTEGRACAO
    REGRA:REGRA_MESMO_PROCEMI
    REGRA:REGRA_REINTEG_EXCLUSAO_EVENTO
    REGRA:REGRA_RETIFICA_MESMO_VINCULO
    REGRA:REGRA_VALIDA_EMPREGADOR"""
    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.evtreintegr"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial.EvtReintegr"


    
    eso11_ideEvento = fields.Many2one(
        comodel_name="eso.11.tideeventotrab",
        string="ideEvento",
        xsd_required=True,
        xsd_type="T_ideEvento_trab"
    )
    
    eso11_ideEmpregador = fields.Many2one(
        comodel_name="eso.11.tideempregador",
        string="ideEmpregador",
        xsd_required=True,
        xsd_type="T_ideEmpregador"
    )
    
    eso11_ideVinculo = fields.Many2one(
        comodel_name="eso.11.tidevinculo",
        string="ideVinculo",
        xsd_required=True,
        xsd_type="T_ideVinculo"
    )
    
    eso11_infoReintegr = fields.Many2one(
        comodel_name="eso.11.inforeintegr",
        string="Informações da reintegração",
        xsd_required=True,
        help="Informações da reintegração.\nCHAVE_GRUPO: {dtEfetRetorno*}"
    )
    
    eso11_Id = fields.Char(
        string="Id",
        xsd_required=True,
        xsd_type="TS_Id"
    )
    

class InfoReintegr(models.AbstractModel):
    """Informações da reintegração.
    CHAVE_GRUPO: {dtEfetRetorno*}"""
    _description = textwrap.dedent("    %s" % (__doc__,))
    _name = "eso.11.inforeintegr"
    _inherit = "spec.mixin.eso"
    _binding_type = "ESocial.EvtReintegr.InfoReintegr"


    
    eso11_tpReint = fields.Selection(INFOREINTEGR_TPREINT,
        string="tpReint",
        xsd_required=True
    )
    
    eso11_nrProcJud = fields.Char(
        string="Em caso de reintegração",
        xsd_type="TS_nrProcJud",
        help=(
            "Em caso de reintegração por determinação judicial, preencher com "
            "o número do processo.\nValidação: Informação obrigatória e "
            "exclusiva se {tpReint}(./tpReint) = [1].\nSe preenchido, deve ser"
            " um processo judicial válido, com 20 (vinte) algarismos."
        )
    )
    
    eso11_nrLeiAnistia = fields.Char(
        string="nrLeiAnistia"
    )
    
    eso11_dtEfetRetorno = fields.Date(
        string="data do efetivo retorno ao trabalho",
        xsd_required=True,
        xsd_type="xs:date",
        help=(
            "data do efetivo retorno ao trabalho.\nValidação: Deve ser uma "
            "data válida, posterior à data de desligamento do trabalhador. Não"
            " pode ser posterior a 30 (trinta) dias da data atual."
        )
    )
    
    eso11_dtEfeito = fields.Date(
        string="data de início dos efeitos financeiros",
        xsd_required=True,
        xsd_type="xs:date",
        help=(
            "data de início dos efeitos financeiros da "
            "reintegração.\nValidação: Deve ser uma data igual ou anterior à "
            "data do efetivo retorno ao trabalho e posterior à data do "
            "desligamento."
        )
    )